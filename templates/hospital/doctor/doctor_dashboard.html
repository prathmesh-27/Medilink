{% extends 'hospital/doctor/doctor_base.html' %}

{% load static %}
{% load widget_tweaks %}
{%block title%}Doctor-Patient{% endblock title %}
{% block pic %}
{% if doctor.profile_pic %}
<img src="{% static doctor.profile_pic %}" alt="Profile Picture" style="width: 80px; border-radius: 50%;">
{% else %}
<img src="{% static 'images/doctor.jpg' %}" alt="Default Profile Picture" style="width: 80px; border-radius: 50%;">
{% endif %}
{% endblock %}

{% block content %}

<style>

.dashboard-container {
  padding: 20px;
  max-width: 1200px;
  margin: auto;
}

/* Cards Section */
.cards-container {
  display: flex;
  justify-content: space-between;
  gap: 20px;
  margin-bottom: 30px;
}

.card {
  background: #ffffff;
  padding: 20px;
  border-radius: 12px;
  box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
  flex: 1;
  text-align: center;
}

.card h3 {
  font-weight: 600;
  margin-bottom: 10px;
  color: #222;
}

.card p {
  font-size: 1.4em;
  color: #00796b;
}

/* Appointments Section */
.appointments-flex {
  display: flex;
  gap: 20px;
  justify-content: space-between;
  flex-wrap: nowrap;
}

/* Table Container Styling */
.table-container {
  background: #fff;
  padding: 15px;
  border-radius: 12px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
  flex: 1;
  overflow: hidden;
}

.table-container h2 {
  margin-bottom: 15px;
  font-size: 20px;
  color: #222;
}

/* Table Styling */
table {
  width: 100%;
  border-collapse: collapse;
  font-size: 14px;
}

thead {
  background-color: #00796b;
  color: #fff;
}

th, td {
  padding: 8px;
  text-align: left;
  border-bottom: 1px solid #ddd;
}

tbody tr:last-child td {
  border-bottom: none;
}

.no-data {
  text-align: center;
  font-style: italic;
  color: #777;
}

/* Profile Image Styling */
table img {
  border-radius: 50%;
  height: 35px;
  width: 35px;
  object-fit: cover;
}


</style>

{% include 'hospital/other/name_role_header.html' %}

<div class="dashboard-container">
  <!-- Statistics Cards -->
  <div class="cards-container">
    <div class="card">
      <h3>Patients</h3>
      <p>{{ patientcount }}</p>
    </div>
    <div class="card">
      <h3>Total Appointments</h3>
      <p>{{ appointmentcount }}</p>
    </div>
    <div class="card">
      <h3>Discharged Patients</h3>
      <p>{{ patientdischarged }}</p>
    </div>
  </div>

  <!-- Today's Appointments -->
  <div class="table-container">
    <h2>Today's Appointments</h2>
    <table>
      <thead>
        <tr>
          <th>Patient Name</th>
          <th>Picture</th>
          <th>Description</th>
          <th>Mobile</th>
          <th>Address</th>
        </tr>
      </thead>
      <tbody>
        {% for a, p in today_appointments %}
        <tr>
          <td>{{ p.name }}</td>
          <td>
            {% if p.profile_pic.url %}
            <img src="{{ p.profile_pic.url }}" alt="Profile Pic" height="40px" width="40px" />
            {% else %}
            <img src="{% static 'images/patient.jpg' %}" alt="Profile Picture" height="40px" width="40px">
            {% endif %}
          </td>
          <td>{{ a.description }}</td>
          <td>{{ p.mobile }}</td>
          <td>{{ p.address }}</td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="6" class="no-data">No appointments for today.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <!-- Upcoming Appointments -->
  <div class="table-container">
    <h2>Upcoming Appointments</h2>
    <table>
      <thead>
        <tr>
          <th>Patient Name</th>
          <th>Picture</th>
          <th>Description</th>
          <th>Mobile</th>
          <th>Address</th>
          <th>Date</th>
        </tr>
      </thead>
      <tbody>
        {% for a, p in upcoming_appointments %}
        <tr>
          <td>{{ p.name }}</td>
          <td>
            {% if p.profile_pic.url %}
            <img src="{{ p.profile_pic.url }}" alt="Profile Pic" height="40px" width="40px" />
            {% else %}
            <img src="{% static 'images/patient.jpg' %}" alt="Profile Picture" height="40px" width="40px">
            {% endif %}

          </td>
          <td>{{ a.description }}</td>
          <td>{{ p.mobile }}</td>
          <td>{{ p.address }}</td>
          <td>{{ a.appointmentDate }}</td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="7" class="no-data">No upcoming appointments.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

{% endblock content %}